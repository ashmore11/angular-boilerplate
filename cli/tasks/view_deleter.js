// Generated by CoffeeScript 1.9.3
(function() {
  var ViewDeleter, fs, utils;

  fs = require('fs');

  utils = require('./utils.js');

  ViewDeleter = (function() {
    ViewDeleter.prototype.paths = {
      coffee: 'src/coffee/controllers/views/',
      jade: 'src/jade/views/',
      stylus: 'src/stylus/views/',
      routes: 'src/coffee/routes/routes.coffee',
      html: 'public/templates/views/'
    };

    function ViewDeleter(view, route) {
      var message;
      message = 'Please pass the name and route of the view you wish to delete: app del [view_name] [route_name]';
      if (!(view && route)) {
        return console.log(message);
      }
      console.log('Deleting view...');
      this.view = view.toLowerCase();
      this.route = route.toLowerCase();
      this.deleteFiles();
      this.deleteRoute();
      console.log("Deleted view: [ " + this.view + " ]");
    }

    ViewDeleter.prototype.deleteFiles = function() {
      fs.unlink(this.paths.coffee + (this.view + ".coffee"), (function(_this) {
        return function(err) {
          if (err) {
            return _this.errorMessage(err);
          }
        };
      })(this));
      fs.unlink(this.paths.jade + (this.view + ".jade"), (function(_this) {
        return function(err) {
          if (err) {
            return _this.errorMessage(err);
          }
        };
      })(this));
      fs.unlink(this.paths.stylus + (this.view + ".styl"), (function(_this) {
        return function(err) {
          if (err) {
            return _this.errorMessage(err);
          }
        };
      })(this));
      return fs.unlink(this.paths.html + (this.view + ".html"), (function(_this) {
        return function(err) {
          if (err) {
            return _this.errorMessage(err);
          }
        };
      })(this));
    };

    ViewDeleter.prototype.deleteRoute = function() {
      return fs.readFile(this.paths.routes, (function(_this) {
        return function(err, data) {
          data = data.toString().replace(utils.routeData(_this.view, _this.route), '');
          return fs.writeFile(_this.paths.routes, data);
        };
      })(this));
    };

    ViewDeleter.prototype.errorMessage = function(error) {
      return console.log("It looks like " + error.path + " wasn't found...");
    };

    return ViewDeleter;

  })();

  module.exports = ViewDeleter;

}).call(this);
